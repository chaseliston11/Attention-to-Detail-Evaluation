<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Attention to Detail & Comprehension Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f4f5f7;
      color: #222;
    }

    .container {
      max-width: 900px;
      margin: 40px auto;
      padding: 24px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.06);
    }

    h1, h2, h3 {
      margin-top: 0;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: #555;
      margin-bottom: 1.5rem;
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    .btn-row {
      margin-top: 24px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      background: #111827;
      color: #fff;
      transition: background 0.2s ease, transform 0.1s ease;
    }

    button.secondary {
      background: #e5e7eb;
      color: #111827;
    }

    button:hover {
      background: #0b1120;
      transform: translateY(-1px);
    }

    button.secondary:hover {
      background: #d1d5db;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: #eef2ff;
      color: #3730a3;
      font-size: 0.8rem;
      margin-bottom: 10px;
    }

    .card {
      border-radius: 14px;
      background: #f9fafb;
      padding: 16px;
      margin: 12px 0;
      border: 1px solid #e5e7eb;
    }

    .question {
      margin: 14px 0;
    }

    .question p {
      margin: 0 0 6px 0;
    }

    label {
      display: block;
      margin: 4px 0;
      font-size: 0.95rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 0.95rem;
    }

    .results-grid {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr;
      gap: 8px;
      padding: 8px 0;
      border-bottom: 1px solid #e5e7eb;
      font-size: 0.9rem;
    }

    .results-grid.header {
      font-weight: 600;
      border-bottom: 2px solid #e5e7eb;
    }

    .badge-good {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: #ecfdf3;
      color: #166534;
    }

    .badge-warn {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: #fef3c7;
      color: #92400e;
    }

    .badge-bad {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: #fef2f2;
      color: #b91c1c;
    }

    .small {
      font-size: 0.8rem;
      color: #6b7280;
    }

    ul {
      padding-left: 1.2rem;
    }

    .highlight {
      background: #fef3c7;
      padding: 2px 4px;
      border-radius: 4px;
    }

    .mono {
      font-family: "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.85rem;
    }
  </style>
</head>
<body>
<div class="container">
  <!-- INTRO -->
  <div id="intro" class="section active">
    <h1>Attention to Detail & Comprehension Assessment</h1>
    <p class="subtitle">
      This assessment measures how accurately and efficiently you handle detailed instructions, data, and written information.
      It is intentionally challenging, and a perfect score is rare.
    </p>

    <div class="card">
      <h3>How it works</h3>
      <ul>
        <li>The test has multiple sections. Each section is <strong>timed automatically</strong>.</li>
        <li>You will be scored on <strong>accuracy</strong> and <strong>speed</strong>.</li>
        <li>At the end, you’ll see:
          <ul>
            <li>Accuracy by section</li>
            <li>Your time vs. a benchmark “average” time</li>
            <li>Key improvement opportunities</li>
          </ul>
        </li>
      </ul>
      <p class="small">
        Tip: Go carefully, not just quickly. Many mistakes come from skimming or making assumptions.
      </p>
    </div>

    <div class="btn-row">
      <button id="startBtn">Start Assessment</button>
    </div>
  </div>

  <!-- SECTION 1: DATA DETAIL -->
  <div id="section1" class="section">
    <span class="pill">Section 1 · Attention to Detail (Employee Data)</span>
    <h2>Identify Records with Incorrect Details</h2>
    <p>
      Below is a list of employee records. Each line contains multiple pieces of information:
      name, ID, department, phone, state, email, manager, job title, location, status, hire date,
      and standard shift.
    </p>
    <p>
      Some records contain <strong>any type of error</strong> (spelling, formatting, mismatched data, inconsistent state, etc.).
      Select <strong>all rows that contain at least one error</strong>. If a row looks perfectly consistent, leave it unchecked.
    </p>

    <div class="card mono">
      <label>
        <input type="checkbox" name="s1" value="row1" />
        1. EMP-2047 · Name: Jonathan Smith · Dept: Finance · Phone: (555) 201-4488 · State: MN ·
           Email: jonathan.smith@example.com · Manager: Kelly Brown · Title: Financial Analyst ·
           Location: Minneapolis, MN · Status: Active · Hire Date: 06/14/2021 · Shift: Mon–Fri, 8:00–5:00
      </label>
      <label>
        <input type="checkbox" name="s1" value="row2" />
        2. EMP-2048 · Name: Jonathon Smith · Dept: Finance · Phone: (555) 201-4488 · State: MN ·
           Email: jonathan.smith@example.com · Manager: Kelly Brown · Title: Financial Analyst ·
           Location: Minneapolis, MN · Status: Active · Hire Date: 06/14/2021 · Shift: Mon–Fri, 8:00–5:00
      </label>
      <label>
        <input type="checkbox" name="s1" value="row3" />
        3. EMP-2051 · Name: Maria Gonzalez · Dept: Sales · Phone: (555) 309-7721 · State: CO ·
           Email: maria.gonzalez@example.com · Manager: David Lee · Title: Account Executive ·
           Location: Denver, CO · Status: Active · Hire Date: 03/02/2020 · Shift: Mon–Fri, 9:00–6:00
      </label>
      <label>
        <input type="checkbox" name="s1" value="row4" />
        4. EMP-20S1 · Name: Maria Gonzales · Dept: Sales · Phone: 555-309-7721 · State: CA ·
           Email: maria.gonzalez@example.com · Manager: David Lee · Title: Account Executive ·
           Location: Denver, CO · Status: Active · Hire Date: 03/02/2020 · Shift: Mon–Fri, 9:00–6:00
      </label>
      <label>
        <input type="checkbox" name="s1" value="row5" />
        5. EMP-2052 · Name: Alex Chen · Dept: Operations · Phone: (555) 441-9830 · State: TX ·
           Email: alex.chen@example.com · Manager: Priya Patel · Title: Operations Manager ·
           Location: Austin, TX · Status: Active · Hire Date: 11/19/2019 · Shift: Mon–Fri, 7:30–4:30
      </label>
      <label>
        <input type="checkbox" name="s1" value="row6" />
        6. EMP-2053 · Name: Alex Chen · Dept: Operation · Phone: (555) 441-983O · State: TX ·
           Email: alex.chen@example.com · Manager: Priya Patel · Title: Operations Manager ·
           Location: Austin, TX · Status: Active · Hire Date: 11/19/2019 · Shift: Mon–Fri, 7:30–4:30
      </label>
    </div>

    <p class="small">
      Hint: Look carefully at spelling, ID patterns, phone number formatting, state vs. location, and numeric characters.
    </p>

    <div class="btn-row">
      <button id="s1Next">Next Section</button>
    </div>
  </div>

  <!-- SECTION 2: READING + DETAIL MCQs -->
  <div id="section2" class="section">
    <span class="pill">Section 2 · Reading & Detail Questions</span>
    <h2>Read Carefully, Then Answer from Memory</h2>
    <p>
      First, read the paragraph below as many times as you like. When you are ready, click
      <strong>"Hide Text & Begin Questions"</strong>. The text will disappear, and the timer will start.
      After the paragraph-based question, you’ll answer additional multiple-choice questions that test attention to detail.
    </p>

    <div class="card" id="readingBlock">
      <p>
        On Saturday afternoon, Laura’s mom asked her to go to the store to pick up
        <span class="highlight">apples</span>, <span class="highlight">nuts</span>, and
        <span class="highlight">water</span>. Her mom was specific that she needed
        <span class="highlight">green apples</span> and exactly <span class="highlight">one gallon of water</span>,
        but she did not mention any particular type of nuts. Laura left the house at
        <span class="highlight">2:10 PM</span>, arrived at the store at
        <span class="highlight">2:25 PM</span>, finished shopping and left the store at
        <span class="highlight">2:47 PM</span>, and arrived back home at
        <span class="highlight">3:05 PM</span>.
      </p>
    </div>

    <div class="btn-row" id="readingActions">
      <button id="hideReadingBtn">Hide Text & Begin Questions</button>
    </div>

    <div id="readingQuestions" style="display:none;">
      <div class="card">
        <!-- Q1: Paragraph-based MCQ -->
        <div class="question">
          <p>1. At what time did Laura arrive back home?</p>
          <label><input type="radio" name="q1" value="home_247" /> 2:47 PM</label>
          <label><input type="radio" name="q1" value="home_305" /> 3:05 PM</label>
          <label><input type="radio" name="q1" value="home_225" /> 2:25 PM</label>
          <label><input type="radio" name="q1" value="home_315" /> 3:15 PM</label>
        </div>

        <!-- Q2: Number precision -->
        <div class="question">
          <p>2. Which number matches <strong>exactly</strong> this value: 10,234.07?</p>
          <label><input type="radio" name="q2" value="num_10234_70" /> 10,234.70</label>
          <label><input type="radio" name="q2" value="num_exact" /> 10,234.07</label>
          <label><input type="radio" name="q2" value="num_10324_07" /> 10,324.07</label>
          <label><input type="radio" name="q2" value="num_10234_7" /> 10,234.7</label>
        </div>

        <!-- Q3: Email exact match -->
        <div class="question">
          <p>3. Which email address matches <strong>exactly</strong>: alex.chen@example.com?</p>
          <label><input type="radio" name="q3" value="email_typo1" /> alex.chen@examp1e.com</label>
          <label><input type="radio" name="q3" value="email_exact" /> alex.chen@example.com</label>
          <label><input type="radio" name="q3" value="email_typo2" /> alex.chan@example.com</label>
          <label><input type="radio" name="q3" value="email_typo3" /> alex.chen@example.co</label>
        </div>

        <!-- Q4: ID pattern -->
        <div class="question">
          <p>4. Which ID matches the pattern <strong>EMP-2053</strong> exactly?</p>
          <label><input type="radio" name="q4" value="id_suffix" /> EMP-2053-A</label>
          <label><input type="radio" name="q4" value="id_exact" /> EMP-2053</label>
          <label><input type="radio" name="q4" value="id_digitswap" /> EMP-2503</label>
          <label><input type="radio" name="q4" value="id_dashvariant" /> EMP2053</label>
        </div>

        <!-- Q5: Date format -->
        <div class="question">
          <p>5. Which date is written in <strong>MM/DD/YYYY</strong> format for March 7th, 2024?</p>
          <label><input type="radio" name="q5" value="date_dmY" /> 07/03/2024</label>
          <label><input type="radio" name="q5" value="date_short" /> 3/7/24</label>
          <label><input type="radio" name="q5" value="date_exact" /> 03/07/2024</label>
          <label><input type="radio" name="q5" value="date_dash" /> 03-07-2024</label>
        </div>

        <!-- Q6: Title case -->
        <div class="question">
          <p>6. Which option uses correct title-style capitalization for the role: manager, hr operations?</p>
          <label><input type="radio" name="q6" value="title_lower" /> manager, hr operations</label>
          <label><input type="radio" name="q6" value="title_partial" /> Manager, Hr Operations</label>
          <label><input type="radio" name="q6" value="title_exact" /> Manager, HR Operations</label>
          <label><input type="radio" name="q6" value="title_allcaps" /> MANAGER, HR OPERATIONS</label>
        </div>

        <!-- Q7: Exact list -->
        <div class="question">
          <p>7. Which list matches <strong>exactly</strong>: "Apples, Nuts, and Water"?</p>
          <label><input type="radio" name="q7" value="list_lower" /> apples, nuts and water</label>
          <label><input type="radio" name="q7" value="list_missing_comma" /> Apples, Nuts and Water</label>
          <label><input type="radio" name="q7" value="list_exact" /> Apples, Nuts, and Water</label>
          <label><input type="radio" name="q7" value="list_extra" /> Apples, Nuts, Water, and Juice</label>
        </div>

        <!-- Q8: Duration math -->
        <div class="question">
          <p>8. A meeting runs from 9:05 AM to 10:20 AM. How many minutes long is it?</p>
          <label><input type="radio" name="q8" value="dur_75" /> 75 minutes</label>
          <label><input type="radio" name="q8" value="dur_85" /> 85 minutes</label>
          <label><input type="radio" name="q8" value="dur_65" /> 65 minutes</label>
          <label><input type="radio" name="q8" value="dur_80" /> 80 minutes</label>
        </div>
      </div>

      <div class="btn-row">
        <button id="s2Next">Next Section</button>
      </div>
    </div>
  </div>

  <!-- SECTION 3: INSTRUCTION FOLLOWING -->
  <div id="section3" class="section">
    <span class="pill">Section 3 · Following Complex Instructions</span>
    <h2>Follow All Instructions Exactly</h2>
    <div class="card">
      <p><strong>Read all questions before making any changes!</strong></p>
      <p>
        Once you have read everything below, follow these instructions exactly:
      </p>
      <ol>
        <li>In the text box labeled <strong>“Favorite color”</strong>, type your favorite color.</li>
        <li>After typing it, erase the entire content so the box is completely blank.</li>
        <li>Do <strong>not</strong> type anything else into that box after you have erased it.</li>
        <li>Select exactly <span class="highlight">two</span> of the four checkboxes below.</li>
        <li>One of the boxes you select <strong>must be “C”</strong>, and you must <strong>not</strong> select box “A”.</li>
        <li>Once you are sure you have followed every instruction, click “Submit &amp; View Results”.</li>
      </ol>
      <p class="small">
        Many people skim and miss at least one detail in this section. Slow down and double-check your actions against the instructions.
      </p>
    </div>

    <div class="card">
      <div class="question">
        <p>Favorite color:</p>
        <input type="text" id="s3Color" placeholder="Follow the instructions above carefully" />
      </div>
      <div class="question">
        <p>Checkboxes:</p>
        <label><input type="checkbox" name="s3" value="A" /> A</label>
        <label><input type="checkbox" name="s3" value="B" /> B</label>
        <label><input type="checkbox" name="s3" value="C" /> C</label>
        <label><input type="checkbox" name="s3" value="D" /> D</label>
      </div>
    </div>

    <div class="btn-row">
      <button id="s3Next">Submit &amp; View Results</button>
    </div>
  </div>

  <!-- RESULTS -->
  <div id="results" class="section">
    <span class="pill">Results</span>
    <h2>Your Assessment Summary</h2>
    <p>
      Below is a breakdown of your performance by section. Scores are based on
      both <strong>accuracy</strong> and <strong>time</strong>, along with some behavioral details for Section 3.
    </p>

    <div class="card">
      <div class="results-grid header">
        <div>Section</div>
        <div>Accuracy</div>
        <div>Time vs. Benchmark</div>
      </div>
      <div class="results-grid">
        <div>Section 1 · Data Detail</div>
        <div id="s1Accuracy"></div>
        <div id="s1Time"></div>
      </div>
      <div class="results-grid">
        <div>Section 2 · Reading & Detail</div>
        <div id="s2Accuracy"></div>
        <div id="s2Time"></div>
      </div>
      <div class="results-grid">
        <div>Section 3 · Instruction Following</div>
        <div id="s3Accuracy"></div>
        <div id="s3Time"></div>
      </div>
    </div>

    <div class="card">
      <h3>Interpretation & Improvement Areas</h3>
      <p id="overallSummary"></p>
      <ul id="improvementList"></ul>
      <h4>Section 3 Behavioral Details</h4>
      <ul id="behaviorList"></ul>
      <p class="small">
        Note: Benchmarks are placeholders. For real usage with candidates/employees,
        you can replace these with your own averages based on collected data.
      </p>
    </div>

    <div class="btn-row">
      <button class="secondary" onclick="location.reload()">Restart Assessment</button>
    </div>
  </div>
</div>

<script>
  // ----- CONFIG: BENCHMARK TIMES (SECONDS) -----
  const BENCHMARKS = {
    section1: 90,   // 1.5 minutes
    section2: 150,  // 2.5 minutes (more questions now)
    section3: 90    // 1.5 minutes
  };

  const state = {
    currentSection: "intro",
    startTimes: {},
    durations: {},
    scores: {},
    section3Behavior: {
      colorEverNonEmpty: false,
      colorWasCleared: false,
      colorEditedAfterClear: false,
      checkboxEverChecked: false,
      checkboxUncheckedAfterCheck: false
    }
  };

  function showSection(id) {
    document.querySelectorAll(".section").forEach(sec => {
      sec.classList.remove("active");
    });
    const target = document.getElementById(id);
    if (target) {
      target.classList.add("active");
      state.currentSection = id;
    }
  }

  function startTimer(sectionId) {
    state.startTimes[sectionId] = performance.now();
  }

  function stopTimer(sectionId) {
    const start = state.startTimes[sectionId];
    if (!start) return;
    const end = performance.now();
    const seconds = (end - start) / 1000;
    state.durations[sectionId] = seconds;
  }

  function formatSeconds(sec) {
    return sec.toFixed(1) + "s";
  }

  function badgeForTime(sec, benchmark) {
    if (!benchmark) return "";

    if (sec <= benchmark * 0.8) {
      return `<span class="badge-good">Faster than average</span>`;
    } else if (sec <= benchmark * 1.2) {
      return `<span class="badge-warn">Around average</span>`;
    } else {
      return `<span class="badge-bad">Slower than average</span>`;
    }
  }

  function badgeForAccuracy(pct) {
    if (pct >= 90) {
      return `<span class="badge-good">${pct}%</span>`;
    } else if (pct >= 70) {
      return `<span class="badge-warn">${pct}%</span>`;
    } else {
      return `<span class="badge-bad">${pct}%</span>`;
    }
  }

  // SCORING: SECTION 1
  function scoreSection1() {
    // Correct error rows: row2, row4, row6
    const correctSet = new Set(["row2", "row4", "row6"]);
    const selected = Array.from(document.querySelectorAll('input[name="s1"]:checked'))
      .map(cb => cb.value);

    const selectedSet = new Set(selected);
    let allMatch = true;

    correctSet.forEach(v => {
      if (!selectedSet.has(v)) {
        allMatch = false;
      }
    });
    selectedSet.forEach(v => {
      if (!correctSet.has(v)) {
        allMatch = false;
      }
    });

    const total = correctSet.size;
    const correct = allMatch ? total : 0; // harsh scoring

    const accuracyPct = (correct / total) * 100;
    state.scores.section1 = { correct, total, accuracyPct };
  }

  // SCORING: SECTION 2 (MCQs + paragraph)
  function scoreSection2() {
    const correctAnswers = {
      q1: "home_305",      // 3:05 PM
      q2: "num_exact",     // 10,234.07
      q3: "email_exact",   // alex.chen@example.com
      q4: "id_exact",      // EMP-2053
      q5: "date_exact",    // 03/07/2024
      q6: "title_exact",   // Manager, HR Operations
      q7: "list_exact",    // Apples, Nuts, and Water
      q8: "dur_65"         // 65 minutes
    };

    const closeAnswers = {
      q1: ["home_247"],                        // picked time she left store
      q2: ["num_10234_70", "num_10234_7"],    // decimal off / truncated
      q3: ["email_typo1", "email_typo3"],     // very close typos
      q4: ["id_digitswap", "id_dashvariant"], // digit swap / missing dash
      q5: ["date_dmY", "date_dash"],          // right digits, wrong format
      q6: ["title_partial"],                  // almost correct capitalization
      q7: ["list_lower", "list_missing_comma"], // text nearly the same
      q8: ["dur_75"]                          // close time estimate
    };

    let correct = 0;
    let total = 8;
    let closeWrong = 0;

    for (let i = 1; i <= total; i++) {
      const name = `q${i}`;
      const chosen = document.querySelector(`input[name="${name}"]:checked`);
      if (!chosen) {
        continue; // unanswered
      }
      const value = chosen.value;

      if (value === correctAnswers[name]) {
        correct++;
      } else if (closeAnswers[name] && closeAnswers[name].includes(value)) {
        closeWrong++;
      }
    }

    const accuracyPct = (correct / total) * 100;
    state.scores.section2 = { correct, total, accuracyPct, closeWrong };
  }

  // SCORING: SECTION 3
  function scoreSection3() {
    const colorValue = document.getElementById("s3Color").value.trim();
    const checkboxes = Array.from(document.querySelectorAll('input[name="s3"]:checked')).map(cb => cb.value);

    let total = 3;
    let correct = 0;

    const behavior = state.section3Behavior;
    const colorCondition =
      behavior.colorEverNonEmpty &&
      behavior.colorWasCleared &&
      !behavior.colorEditedAfterClear &&
      colorValue === "";

    if (colorCondition) correct++;

    if (checkboxes.length === 2) correct++;

    const hasC = checkboxes.includes("C");
    const hasA = checkboxes.includes("A");
    if (hasC && !hasA) correct++;

    const accuracyPct = (correct / total) * 100;
    state.scores.section3 = { correct, total, accuracyPct };
  }

  function buildResults() {
    const s1 = state.scores.section1 || { accuracyPct: 0 };
    const s1TimeSec = state.durations.section1 || 0;
    document.getElementById("s1Accuracy").innerHTML = badgeForAccuracy(Math.round(s1.accuracyPct));
    document.getElementById("s1Time").innerHTML =
      `${formatSeconds(s1TimeSec)}<br/><span class="small">${badgeForTime(s1TimeSec, BENCHMARKS.section1)}</span>`;

    const s2 = state.scores.section2 || { accuracyPct: 0, closeWrong: 0 };
    const s2TimeSec = state.durations.section2 || 0;
    document.getElementById("s2Accuracy").innerHTML = badgeForAccuracy(Math.round(s2.accuracyPct));
    document.getElementById("s2Time").innerHTML =
      `${formatSeconds(s2TimeSec)}<br/><span class="small">${badgeForTime(s2TimeSec, BENCHMARKS.section2)}</span>`;

    const s3 = state.scores.section3 || { accuracyPct: 0 };
    const s3TimeSec = state.durations.section3 || 0;
    document.getElementById("s3Accuracy").innerHTML = badgeForAccuracy(Math.round(s3.accuracyPct));
    document.getElementById("s3Time").innerHTML =
      `${formatSeconds(s3TimeSec)}<br/><span class="small">${badgeForTime(s3TimeSec, BENCHMARKS.section3)}</span>`;

    const overallSummary = document.getElementById("overallSummary");
    const improvementList = document.getElementById("improvementList");
    const behaviorList = document.getElementById("behaviorList");
    improvementList.innerHTML = "";
    behaviorList.innerHTML = "";

    const avgAccuracy = (
      (s1.accuracyPct + s2.accuracyPct + s3.accuracyPct) / 3
    ).toFixed(1);

    overallSummary.textContent =
      `Your overall accuracy across all sections was ${avgAccuracy}%. `
      + `This assessment is intentionally difficult. Use these results to identify where additional focus on detail and comprehension will be most helpful.`;

    // Targeted improvement tips
    if (s1.accuracyPct < 90) {
      const li = document.createElement("li");
      li.textContent =
        "Section 1 (Data Detail): Practice scanning for subtle inconsistencies across multiple fields (name, ID, state, formatting). Slow down and compare items line by line.";
      improvementList.appendChild(li);
    }

    if (s2.accuracyPct < 90) {
      const li = document.createElement("li");
      li.textContent =
        "Section 2 (Reading & Detail): Work on locking in exact details (times, numbers, spelling, capitalization). Double-check before committing to an answer, especially when options look very similar.";
      improvementList.appendChild(li);
    }

    if (s2.closeWrong && s2.closeWrong > 0) {
      const li = document.createElement("li");
      li.textContent =
        `Section 2: You had ${s2.closeWrong} answer(s) that were very close but still incorrect. This often indicates you are noticing patterns but not verifying the final detail (digit, letter, or punctuation) carefully enough.`;
      improvementList.appendChild(li);
    }

    if (s3.accuracyPct < 90) {
      const li = document.createElement("li");
      li.textContent =
        "Section 3 (Instructions): Focus on reading all instructions fully before acting. Many errors come from acting too quickly after only skimming.";
      improvementList.appendChild(li);
    }

    if (
      s1.accuracyPct >= 90 &&
      s2.accuracyPct >= 90 &&
      s3.accuracyPct >= 90
    ) {
      const li = document.createElement("li");
      li.textContent =
        "Strong performance across all sections. Continue to balance speed with accuracy—particularly when stakes are high or details are critical.";
      improvementList.appendChild(li);
    }

    // Section 3 behavioral details
    const b = state.section3Behavior;

    const li1 = document.createElement("li");
    li1.textContent = b.colorEverNonEmpty
      ? "Favorite color box: You entered a value at least once."
      : "Favorite color box: You never entered a value, which does not follow the instruction to type your favorite color before erasing it.";
    behaviorList.appendChild(li1);

    const li2 = document.createElement("li");
    li2.textContent = b.colorWasCleared
      ? "Favorite color box: You cleared the text at least once."
      : "Favorite color box: The text was never fully cleared.";
    behaviorList.appendChild(li2);

    const li3 = document.createElement("li");
    li3.textContent = b.colorEditedAfterClear
      ? "Favorite color box: You typed again after erasing, which goes against the instruction not to add details after clearing the field."
      : "Favorite color box: You did not type again after clearing the field.";
    behaviorList.appendChild(li3);

    const li4 = document.createElement("li");
    li4.textContent = b.checkboxEverChecked
      ? "Checkboxes: At least one checkbox was selected at some point."
      : "Checkboxes: No checkbox was ever selected.";
    behaviorList.appendChild(li4);

    const li5 = document.createElement("li");
    li5.textContent = b.checkboxUncheckedAfterCheck
      ? "Checkboxes: At some point, all previously selected boxes were cleared, suggesting changes after initial actions."
      : "Checkboxes: There is no indication that all selected boxes were later cleared.";
    behaviorList.appendChild(li5);
  }

  document.addEventListener("DOMContentLoaded", () => {
    // Intro -> Section1
    document.getElementById("startBtn").addEventListener("click", () => {
      showSection("section1");
      startTimer("section1");
    });

    // Section 1 -> Section 2
    document.getElementById("s1Next").addEventListener("click", () => {
      stopTimer("section1");
      scoreSection1();
      showSection("section2");
      // timer for section2 starts after reading is hidden (when questions begin)
    });

    // Hide reading & show questions (start timer)
    document.getElementById("hideReadingBtn").addEventListener("click", () => {
      const block = document.getElementById("readingBlock");
      const actions = document.getElementById("readingActions");
      const questions = document.getElementById("readingQuestions");
      block.style.display = "none";
      actions.style.display = "none";
      questions.style.display = "block";
      startTimer("section2");
    });

    // Section 2 -> Section 3
    document.getElementById("s2Next").addEventListener("click", () => {
      stopTimer("section2");
      scoreSection2();
      showSection("section3");
      startTimer("section3");
    });

    // Track Section 3 favorite color behavior
    const colorInput = document.getElementById("s3Color");
    colorInput.addEventListener("input", () => {
      const val = colorInput.value;
      const b = state.section3Behavior;

      if (val.length > 0) {
        if (!b.colorEverNonEmpty) {
          b.colorEverNonEmpty = true;
        }
        if (b.colorWasCleared) {
          b.colorEditedAfterClear = true;
        }
      } else {
        if (b.colorEverNonEmpty) {
          b.colorWasCleared = true;
        }
      }
    });

    // Track Section 3 checkbox behavior
    const s3Checkboxes = document.querySelectorAll('input[name="s3"]');
    s3Checkboxes.forEach(cb => {
      cb.addEventListener("change", () => {
        const anyChecked = Array.from(document.querySelectorAll('input[name="s3"]'))
          .some(c => c.checked);
        const b = state.section3Behavior;

        if (anyChecked) {
          if (!b.checkboxEverChecked) {
            b.checkboxEverChecked = true;
          }
        } else {
          if (b.checkboxEverChecked) {
            b.checkboxUncheckedAfterCheck = true;
          }
        }
      });
    });

    // Section 3 -> Results
    document.getElementById("s3Next").addEventListener("click", () => {
      stopTimer("section3");
      scoreSection3();
      buildResults();
      showSection("results");
    });
  });
</script>
</body>
</html>
